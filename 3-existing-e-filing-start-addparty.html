<head>
    <meta charset="utf-8">
    
    <meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0">
    <meta name="google-site-verification" content="CQVS3uzTnc6cdOiq2rWykU2bSVkYKhpV2PwCBtiLzz0">
    <meta http-equiv="cache-control" content="max-age=0">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="pragma" content="no-cache">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Federal Court - File Document(s) on Existing Proceeding</title>
    <meta name="description" content="">
    <meta name="robots" content="all,follow">

    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="https://efiling.fct-cf.gc.ca/content/vendors/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <!-- Google fonts - Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700,300,100">
    <!-- owl carousel-->
    <link rel="stylesheet" href="https://efiling.fct-cf.gc.ca/content/vendors/owl.carousel/assets/owl.carousel.css">
    <link rel="stylesheet" href="https://efiling.fct-cf.gc.ca/content/vendors/owl.carousel/assets/owl.theme.default.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="https://efiling.fct-cf.gc.ca/content/css/base/style.gold.css" id="theme-stylesheet">
    <link href="https://efiling.fct-cf.gc.ca/Content/vendors/DataTables/DataTables-1.10.18/css/dataTables.bootstrap4.min.css" rel="stylesheet">
    <link href="https://efiling.fct-cf.gc.ca/Content/vendors/DataTables/Buttons-1.5.4/css/buttons.bootstrap4.min.css" rel="stylesheet">
    <link href="https://efiling.fct-cf.gc.ca/Content/vendors/DataTables/Buttons-1.5.4/css/buttons.dataTables.min.css" rel="stylesheet">
    <link href="https://efiling.fct-cf.gc.ca/Content/vendors/DataTables/Responsive-2.2.2/css/responsive.bootstrap4.min.css" rel="stylesheet">
    <link href="https://efiling.fct-cf.gc.ca/Content/vendors/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet">
    <link href="https://efiling.fct-cf.gc.ca/Content/vendors/DataTables/ColReorder-1.5.0/css/colReorder.bootstrap4.min.css" rel="stylesheet">
    <!-- Favicon-->
    
    <link href="https://efiling.fct-cf.gc.ca/Content/css/timepicker/jquery.timeselector.css" rel="stylesheet">

    <link rel="stylesheet" href="https://efiling.fct-cf.gc.ca/content/css/base/loading.css">

    <link rel="shortcut icon" href="https://efiling.fct-cf.gc.ca/content/img/base/favicon.ico">

    <link rel="stylesheet" type="text/css" href="https://efiling.fct-cf.gc.ca/content/css/base/ie.css">

    

    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="https://efiling.fct-cf.gc.ca/content/css/base/custom.css">

    <!-- Tweaks for older IEs-->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!--CSS stylesheets added as part of content edits-->
    <!--Custom styling-->
    <link rel="stylesheet" href="customcss.css">
    <!-- New Font Awesome CSS (6) - for 'X' icon-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://efiling.fct-cf.gc.ca/content/vendors/jquery/jquery.min.js"></script>

</head>
<body>
    <ul id="wb-tphp">
        <li class="wb-slc"><a class="wb-sl" href="#cont">Skip to main content</a></li>
        <li class="wb-slc visible-sm visible-md visible-lg"><a class="wb-sl" href="#info">Skip to "About this site"</a></li>
    </ul>

    

    <!-- navbar-->
    <header class="header mb-05">

        <div id="top">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-1 text-right d-none d-xl-block d-lg-block d-md-block ">
                        <ul class="menu list-inline mb-0">
                            <li class="list-inline-item">

                               <!-- Conditional browser compatibility message-->
                              <span style="color:whitesmoke;">
                                <nobr>
                                <script>
                                    if (window.navigator.userAgent.includes("Edg", "IE")) {
                                document.write("This site is best viewed with Google Chrome or Mozilla Firefox.");
                            }
                                </script>
                                </nobr>
                                </span>
                            </li>
                        </ul>
                    </div>
            
                </div>
            </div>
        </div>

        

    </header>


    <div id="all">
        <div id="content">
            <div class="container-fluid">

<div class="row">
    <div class="col-lg-12">
    </div>
</div>                <div class="row justify-content-center"><p id="demo"></p></div>
            </div>




<style>
    .error {
        color: red;
    }

    .custom-file-label::after {
        content: 'Browse' !important;
    }
</style>

<div class="container-fluid">
    <div class="row">
        
<div class="col-lg-12">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            
            <li aria-current="page" class="breadcrumb-item">

                <a href="https://efiling.fct-cf.gc.ca/en/online-access/e-filing-intro">E-Filing home</a>
            </li>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
            <a href="https://www.fct-cf.gc.ca/Content/assets/pdf/base/2022-09-07-ENG-User-Guide-Online-Access.pdf" target="new"> E-Filing user guide</a>
            
     
            </li>
<p align=right><li aria-current="page" class="ml-auto">
    <a lang="fr" href="https://efiling.fct-cf.gc.ca/fr/acces-en-ligne/new-e-filing-start" id="lnkLanguageToggle">
            Fran√ßais
    </a></p>
        </ol>
    </nav>
</div>

    </div>
</div>
<div class="container-fluid">
    <div class="row">


        <div class="col-lg-12">
            <div class="box">

                <ul class="nav nav-tabs flex-column flex-md-row nav-pills text-center" id="tablist" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-0-tab" href="#step-0"
                           role="tab" aria-controls="step-0" aria-selected="true">
                            <i class="fa-solid fa-search" aria-hidden="true"></i> 1. Find file
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-1-tab" href="#step-1"
                           role="tab" aria-controls="step-1" aria-selected="true">
                            <i class="fa-solid fa-gavel" aria-hidden="true"></i>&nbsp;&nbsp;2. View file information
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center active" id="step-2-tab" href="#step-2" role="tab"
                           aria-controls="step-2" aria-selected="false">
                            <i class="fa fa-user-plus" aria-hidden="true"></i> 3. View parties
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-3-tab" href="#step-3" role="tab"
                           aria-controls="step-3" aria-selected="false">
                            <i class="fa fa-file-text" aria-hidden="true"></i> 4. Add document(s)
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-3b-tab" href="#step-3b" role="tab"
                           aria-controls="step-3b" aria-selected="false">
                            <i class="fa fa-file-text" aria-hidden="true"></i> 4. Add document(s)
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-3c-tab" href="#step-3c" role="tab"
                           aria-controls="step-3c" aria-selected="false">
                            <i class="fa fa-file-text" aria-hidden="true"></i> 4. Add document(s)
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-4-tab" href="#step-4" role="tab"
                           aria-controls="step-4" aria-selected="false">
                            <i class="fa fa fa-envelope" aria-hidden="true"></i> 5. Update contact information
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link flex-sm-fill text-sm-center disabled" id="step-5-tab" href="#step-5" role="tab"
                           aria-controls="step5" aria-selected="false">
                            <i class="fa-solid fa-square-check" aria-hidden="true"></i> 6. Review
                        </a>
                    </li>
                </ul>
<br>
                            <div class="col-sm-6 px-0">
                                <div class="box">
                                    <center><b><label for="Court_Number">Court number</label></b>: T-1538-23 &nbsp;&nbsp;&nbsp;&nbsp;
                                    <b><label for="Style_Of_Cause">Style of cause</label></b>: ALAIN LAJEUNESSE c. PGC</center>
                                </div>
                                </div>
                                
                            <div class="tab-pane fade show active" id="step-1" role="tabpanel" aria-labelledby="step-1-tab">
                                <br>
                                <h3>2. View parties</label></h3>
                                <p class="tableinstructions">Review the details below. If you need to add a party, please include the document to do so in <b>4. Add document(s)</b>.</b></p>

                    


                         


<div id="numPartiesReq" hidden="">2</div>
<div class="row" style="padding-top:30px;">
    <div class="col-sm-12">
        <div class="form-group">
            <div class="table-responsive">
                
                <table id="datatable" class="table wb-tables table-striped table-hover table-bordered dataTable no-footer dtr-inline" style="width: 100%;" role="grid" aria-describedby="datatable_info">
                    <thead>
                        <tr role="row">
                            <th>Party name</th>
                            <th>Party role</th>
                            <th>Party type</th>

                        </tr>
                 </thead>
                    <tbody>
                                <tr>
                                    <td>AGENCE DU REVENU DU CANADA</td>
                                    <td>Respondent (application)</td>
                                    <td>Other</td>
                                  
                                </tr>

                                <tr>
                                    <td>Alain Lajeunesse</td>
                                    <td>Applicant</td>
                                    <td>Individual</td>
                                  
                                </tr>
                    </tbody>
            
            
                            </table>
            </div>
        </div>
    </div>
</div>

</div>
                            <div class="box-footer d-flex justify-content-between pull-right">
                                <button type="button" class="btn btn-outline-secondary" id="Back-Step-3">
                                    <i class="fa fa-chevron-left"></i>Back
                                </button>
                            
                                <a href="5-new-e-filing-start-adddocument-3c.html" type="button" class="btn btn-secondary">
                                    Next
                                    <i class="fa fa-chevron-right"></i>
                                </a>
                                </button>
                            </div>
                            </form>
                            <br>
                            <div class="box-footer">
                                <div class="box">
                                    <h4>Share your feedback</h4>
                                    <p>Take 5 minutes to let us know about your experience. The survey will open in a new browser tab.</p>
                                    <a href="https://forms.microsoft.com/r/1YCRBV91uf" target="new" type="button" class="btn btn-secondary">Start survey</a>
                            </div>
                            
                            </form>                    </div><!--End pane-->


    
    <div id="footer">
        <div class="container-fluid">
            <div class="row" id="info">
                <div class="col-md-4">
                    <div class="row">
                        <div class="col-md-4"></div> <!-- this column empty -->
                        <div class="col-md-4">
                            <h4 class="mb-2">About the Court</h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/about-the-court/jurisdiction#cont">
                                        Jurisdiction
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/about-the-court/Careers#cont">
                                        Careers
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/about-the-court/liaison-committees#cont">
                                        Liaison Committees
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/about-the-court/reports-and-statistics#cont">
                                        Reports and Statistics
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h4 class="mb-2">Law and Practice</h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/law-and-practice/acts-and-rules#cont">
                                        Acts and Rules
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/practice-guides#cont">
                                        Practice Guides
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/procedural-charts#cont">
                                        Procedural Charts
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/procedural-roadmaps#cont">
                                        Procedural Roadmaps
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/law-and-practice/court-costs#cont">
                                        Court Costs
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/representing-yourself/deadlines-calculator#cont">
                                        Deadlines Calculator
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/checklists#cont">
                                        Checklists
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
    
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-2">
                            <h4 class="mb-2">Online Access</h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/online-access/forms">
                                        Forms
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/online-access/e-filing-intro">
                                        E-Filing
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://fct-u/en/online-access/e-motion">
                                        E-Motion
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://fct-u/en/online-access/e-order">
                                        E-Order
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-2">
                            <h4 class="mb-2">Representing Yourself</h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/finding-legal-help#cont">
                                        Finding Legal Help 
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/practice-guides#cont">
                                        Practice Guides
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/procedural-charts#cont">
                                        Procedural Charts
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/procedural-roadmaps#cont">
                                        Procedural Roadmaps
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/checklists#cont">
                                        Checklists
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/law-and-practice/court-costs#cont">
                                        Court Costs
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/representing-yourself/deadlines-calculator#cont">
                                        Deadlines Calculator
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/resolving-your-case#cont">
                                        Resolving Your Case
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/registry#cont">
                                        Registry
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-2">
                            <h4 class="mb-2">Court Files and Decisions</h4>
                            <ul class="list-unstyled">
    
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/court-files-and-decisions/court-files#cont">
                                        Court Files
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://decisions.fct-cf.gc.ca/fc-cf/en/d/s/index.do?col=54">
                                        Decisions
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/court-files-and-decisions/hearing-lists#cont">
                                        Hearing Lists
                                    </a>   
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/court-files-and-decisions/hearings/general-sittings#cont">
                                        General Sittings
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/court-files-and-decisions/hearings/summer-recess#cont">
                                        Summer Recess
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/court-files-and-decisions/hearings-calendar#cont">
                                        Calendar of Hearings
                                    </a>
                                </li>
    
                            </ul>
                        </div>
                        <div class="col-md-2">
                            <h4 class="mb-2">Media</h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/media/administration-of-the-court#cont">
                                        Administration of the Court
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/court-files-and-decisions/court-files#cont">
                                        Court Files
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="footerlink" href="https://decisions.fct-cf.gc.ca/fc-cf/en/d/s/index.do?col=54">
                                        Decisions
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/court-files-and-decisions/hearings-calendar#cont">
                                        Calendar of Hearings
                                    </a>
                                </li>
                            </li>
                            <li class="nav-item">
                                <a class="footerlink" href="https://twitter.com/FedCourt_CAN_en">
                                X/Twitter
                                    <i class="fa-brands fa-square-x-twitter"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="footerlink" href="https://www.youtube.com/channel/UCQ24-5tXhkQXTg9sMCEkuWg" title="YouTube" rel="external" target="_blank">
                                    YouTube
                                    <i class="fab fa-youtube"></i>
                            </a>
                        </li>
                            </ul>
                        </div>
                        <div class="col-md-2">
                            <h4 class="mb-2">
                                Resources
                            </h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/registry#cont">
                                        Registry
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages//law-and-practice/court-costs#cont">
                                        Court Costs
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/procedural-charts#cont">
                                        Procedural Charts
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/procedural-roadmaps#cont">
                                        Procedural Roadmaps
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/resolving-your-case#cont">
                                        Resolving Your Case
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/finding-legal-help#cont">
                                        Finding Legal Help 
                                    </a>
                                </li>
                                <li>
                                    <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/checklists#cont">
                                        Checklists
                                    </a>
                                </li>
    
                            </ul>
                        </div>
                        <div class="col-md-2"></div> <!-- this column empty -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
        
    <div id="copyright">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <p class="text-center">
                        <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/important-notices">
                            Important Notices
                        </a>
                        |
                        <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/disclaimer">
                            Disclaimer
                        </a>
                        |
                        <a class="footerlink" href="https://www.fct-cf.gc.ca/en/pages/representing-yourself/contact-us">
                            Contact Us
                        </a>
                        |
                        <a class="footerlink" href="https://www.fct-cf.gc.ca/en/home/feedback">
                            Feedback
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript files-->

    <script src="https://efiling.fct-cf.gc.ca/content/vendors/popper.js/umd/popper.min.js"></script>
    <script src="https://efiling.fct-cf.gc.ca/content/vendors/bootstrap/js/bootstrap.min.js"></script>
    
    <script src="https://efiling.fct-cf.gc.ca/Content/vendors/js-cookie/js.cookie.js"></script>
    <script src="https://efiling.fct-cf.gc.ca/content/vendors/owl.carousel/owl.carousel.min.js"></script>
    <script src="https://efiling.fct-cf.gc.ca/content/vendors/owl.carousel2.thumbs/owl.carousel2.thumbs.js"></script>
    
<script src="https://efiling.fct-cf.gc.ca/Scripts/jquery.validate.js"></script>
    
    <script src="https://efiling.fct-cf.gc.ca/Content/vendors/jquery/jquery.unobtrusive-ajax.js"></script>

    <script src="https://efiling.fct-cf.gc.ca/Content/vendors/moment/min/moment-with-locales.min.js"></script>

    <script src="https://efiling.fct-cf.gc.ca/Content/js/base/js.js"></script>
    <script src="https://efiling.fct-cf.gc.ca/Content/js/base/utils.js"></script>
    <script src="https://efiling.fct-cf.gc.ca/Content/js/base/data.js"></script>

    
    
    <script src="https://efiling.fct-cf.gc.ca/Content/js/timepicker/jquery.timeselector.js"></script>

    



    <script>
        $(function () {

            //used to control navigation for OnlineAccess
            var OnlineAccess = false;
            //var fileDateValid = false;
            var listOfOnlineAccessDocs = [];
            //determines which pathway will be followed for navigation - controlled by Validate3B()
            var pathway = 0;
            var exemptionParty = "";
            var modelCourtForUser = "";

            var proNature;
            var proSubject;
            var proClassAction;

            var lang = "False";



            //const obj = JSON.parse(jsonTest);


            

            $('.ajaxSignatures').hide();
            $("#Signatures").prop('checked', false);

            //ensure additional step 3b and step 3c tabs are hidden at start
            $("#step-3b-tab").hide();
            $("#step-3c-tab").hide();

            var hidden = false;
            var sigsNeeded = false;
            var isValidCourt = false;
            var shownCourt = false;
            var rowCount = 0;
            var userDefinedParty = []; //elements from party form
            var fileList = [];  //elements from documents form
            var tablistelement = document.getElementById("tablist");
            var databaseDefinedParty = []; //elements from party form



            $('.error').each(function () {

                $(this).css('color', 'red');
            });

            $(document).on('change', '.dropdowntarget', function () {
                var element = this;
                var id = element.name.match(/\d+/);
                RestrictDropDown(id[0]);
            });

            $(document).keypress(function (e) {
                var code = (e.keyCode || e.which);
                if (code == 60 || code == 62 || code == 59 || code === 13) {   //           console.log("We got it");
                    e.preventDefault();
                }
            });

            // Execute a function when the user releases a key on the keyboard
            userEnteredCourtNo.addEventListener("keypress", function (event) {
                // Number 13 is the "Enter" key on the keyboard
                if (event.keyCode === 13) {
                    // Cancel the default action, if needed
                    //event.preventDefault();
                    // Trigger the button element with a click
                    //document.getElementById("Submit-Step-1").click();
                    document.getElementById("Submit-Step-1").click();
                   // alert('step one')
                    //this.form.submit();
                }
                //if (event.keyCode == 32) {
                //    return false;
                //    //this.value = this.value.replace(/[\W]/g, '_');
                //}
            });

            $(document).on("keydown", "#userEnteredCourtNo", function (evt) {
                if (evt.keyCode == 32) {
                    return false;
                }
            });

            $('#userEnteredCourtNo').on('click', function () {
                $('#courtNumberNotFound').html("");
            });


            function processDataBaseTable() {
                $('#PartyList tr').each(function () {
                    var Party = {};
                    Party.role = $(this).find("td:eq(0)").text();
                    Party.type = $(this).find("td:eq(1)").text();
                    Party.firstName = $(this).find("td:eq(2)").text();
                    Party.lastName = $(this).find("td:eq(3)").text();
                    //add to existing
                    databaseDefinedParty.push(Party);
                });
            }

            function CourtNumberExist() {

                var model = {
                    //form1
                    userEnteredCourtNo: $('#userEnteredCourtNo').val().toUpperCase().replace(/\s/g, ""),
                    lang: "False"
                };

                var jsonToPost = JSON.stringify(model);

                $.ajax({
                    type: "POST",
                    url: '/onlineaccess/CourtLookUp',
                    data: jsonToPost,
                    dataType: "json",
                    async: false,
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        isValidCourt = result;
                    }
                })
            }

            function SetupEvents() {

                $('#Back-Step-1').on("click", function (e) {
                    e.preventDefault();
                    if (GenerateTextBox()) {
                        shownCourt = false;
                        isValidCourt = false;

                        $('.ajaxNewCourtData').load("/onlineaccess/enterCourtData", { lang: "False" });
                        window.location.reload();
                    }

                });

                $('#Back-Step-2').on("click", function (e) {
                    e.preventDefault();
                    if (GenerateTextBox()) {
                        $('#tablist a[href="#step-1"]').tab('show');
                        userDefinedParty = []; //reset our lists
                        databaseDefinedParty = [];
                        counter = 0;
                        shownCourt = false;
                        isValidCourt = false;
                        $('iOfficeNumber').val("");
                        //clear table
                        $('.ajaxNewCourtData').load("/onlineaccess/enterCourtData", { lang: "False" });
                        $("#PartyList  tbody").empty();
                    }
                });

                $('#Back-Step-3').on("click", function (e) {
                    e.preventDefault();
                    if (GenerateTextBox()) {
                        $('#tablist a[href="#step-2"]').tab('show');
                        fileList = [];
                        otherCounter = 0;

                        userDefinedParty = [];//prevent double scrape
                        //clear table
                        $("#docList tbody").empty();
                        deleteFiles();
                        if (sigsNeeded) {
                            $('.ajaxSignatures').hide();
                            $("#Signatures").prop('checked', false);
                        }
                        sigsNeeded = false;
                    }
                });

                $('#Back-Step-3b').on("click", function (e) {
                    e.preventDefault();
                    if (GenerateTextBox()) {
                        $("#documentList3b").empty();
                    }


                    $('#step-3b-tab').hide();
                    $('#step-3-tab').show();
                    $('#step-3-tab').removeClass("disabled");
                    $('#tablist a[href="#step-3"]').tab('show');
                });

                $('#Back-Step-3c').on("click", function (e) {
                    e.preventDefault();
                    if (GenerateTextBox()) {

                        //clear fields
                        $("#exemptionDocNames").html("");
                        $("#exemptionFile").val('');
                        $("#exemptionDocumentLanguage").selectedIndex = 0;

                    }


                    $('#step-3c-tab').hide();
                    $('#step-3b-tab').show();
                    $('#step-3b-tab').removeClass("disabled");
                    $('#tablist a[href="#step-3b"]').tab('show');
                });

                $('#Back-Step-4').on("click", function (e) {

                    e.preventDefault();
                    if (GenerateTextBox()) {
                        deleteFiles();

                        if (OnlineAccess && pathway == 2) {
                            $('#tablist a[href="#step-3c"]').tab('show');
                        }
                        else {
                            $("#documentList3b").empty();
                            $('#tablist a[href="#step-3"]').tab('show');
                        }

                    }
                });

                $('#Back-Step-5').on("click", function (e) {
                    e.preventDefault();
                    if (GenerateTextBox()) {
                        $('#tablist a[href="#step-4"]').tab('show');
                        if (hidden) {
                            $(".stepFive").show();
                            hidden = false;
                        }
                    }


                });


                $("#form1").validate({
                    rules: {
                        userEnteredCourtNo: {
                            required: true
                        }
                    },
                    messages: {
                        userEnteredCourtNo: "<span style=\"color: red;\">&nbsp Court Number is required.</span>",
                    }
                });



                $("#Submit-Step-1").on("click", function (e) { //Proceeding Info
                    e.preventDefault();
                    if ($("#form1").valid()) {

                        //set session timeout
                        setTimeout('window.location.replace("/en/online-access/sessionExpiration")', 3600000);
                        //var countDownDate = new Date("Jan 5, 2021 15:37:25").getTime();
                        //var countDownDate = new Date(new Date().getTime() + 60 * 60000);
                        //// Update the count down every 1 second
                        //var x = setInterval(function () {

                        //    // Get today's date and time
                        //    var now = new Date().getTime();

                        //    // Find the distance between now and the count down date
                        //    var distance = countDownDate - now;

                        //    // Time calculations for days, hours, minutes and seconds
                        //    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                        //    var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                        //    // Display the result in the element with id="demo"
                        //    document.getElementById("demo").innerHTML = minutes + "m " + seconds + "s ";

                        //    // If the count down is finished, write some text
                        //    if (distance < 0) {
                        //        clearInterval(x);
                        //        document.getElementById("demo").innerHTML = "EXPIRED";
                        //    }
                        //}, 1000);


                        //need to look up the court number
                        if (shownCourt) {
                            //ajax the heading for all headings
                            $('.ajaxHeading').load("/onlineaccess/updateHeader", { lang: "False" });
                            //ajax the partyTable in
                            $('.ajaxNewPartyData').load("/onlineaccess/updatePartyData", { lang: "False" }, function () {
                                //rebind the onclick events
                                $("#addrow_Party").on("click", addParty);
                                $("#PartyList").on("click", ".ibtnDel", removePartyRow);

                                rowCount = $('#PartyList tr').length;
                                rowCount = rowCount - 2; //button and labels
                                processDataBaseTable();
                            });

                            $('#step-2-tab').removeClass("disabled");
                            $('#tablist a[href="#step-2"]').tab('show');



                        }
                        else {
                            CourtNumberExist();
                            console.log('...looking up court case');
                            if (isValidCourt) {
                                //ajax in the new Court Data
                                var courtNo = $("#userEnteredCourtNo").val();
                                $('.ajaxNewCourtData').load("/onlineaccess/updateCourtData", { pageLang: "False", courtNumber: courtNo });
                                shownCourt = true;



                                //store C# model so we can access it in javascript for online access project
                            
                                //populateModel();



                            }
                            else {
                                console.log('Court Number not found');
                                $('#courtNumberNotFound').html("<font color = 'red'>The Court Number you are searching for was not found. Please enter another Court Number.</font>");

                            }
                            //need to do parties as well??
                            //need a way to build table
                        }
                    }
                    else {
                        console.log('not valid');
                    }
                });
            }

            $('#isUrgent').change(function () {
                var urgency = $('#isUrgent').prop('checked');

                if (urgency) {
                    $('#urgDesc').removeAttr('disabled');
                } else {
                    $('#urgDesc').attr('disabled', 'disabled');
                    $('#urgDesc').val('');
                }
            });

            function updateAllSignatures() {

                var i = 0;
                var dTypes = [];
                for (i = 0; i < otherCounter; i++) {
                    dTypes.push($('#DocumentType_' + i).find('option:selected').text());

                }


                $.ajax({
                    type: "POST",
                    url: '/onlineaccess/areSignaturesStillNeeded',
                    dataType: "json",
                    async: false,
                    data: JSON.stringify({ lod: dTypes }),
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        sigsNeeded = result;
                        if (!sigsNeeded) {
                            $('.ajaxSignatures').hide();
                            $("#Signatures").prop('checked', false);
                        }
                        else
                            $('.ajaxSignatures').show();
                    }
                });

            }

            SetupEvents();

            function isUrgencyChecked() {
                if ($('#isUrgent').prop('checked')) {
                    $('#urgDesc').rules("add",
                        {
                            required: true,
                            messages: { required: "<span style=\"color: red;\">Urgency description required</span>" }
                        });
                    return true;
                }
                else {
                    $('#urgDesc').rules("remove");
                    return false;
                }
            }

            function areFilingPartiesAssigned() {
                var i = 0;
                var j = 0;
                //need at least one checked per row
                var retVal = false;
                var numParties = userDefinedParty.length;
                for (i = 0; i < otherCounter; i++) {
                    //check database
                    for (j = 0; j <= numParties; j++) {
                        if ($('#filer_' + i + '_' + j).prop('checked') == true) {
                            retVal = true;
                            if (exemptionParty == "") {
                                exemptionParty = $('#filer_' + i + '_' + j).parent().text();
                            }
                        }
                    }
                    ////check normal entries
                    //for (j = 0; j < counter; j++) {
                    //    var y = (j + rowCount + 1);
                    //    if ($('#filer_' + i + '_' + y).prop('checked') == true) {

                    //        retVal = true;

                    //        //set the exemption file party to the first one checked. We need some sort of default value for this document,
                    //        //and there is no input for the party on 3C
                    //        if (exemptionParty == "") {
                    //            exemptionParty = $('#filer_' + i + '_' + j).parent().text();
                    //        }
                    //    }

                        if (retVal != true)
                            return false;
                        //reset for next roww
                        retVal = false;
                    }
                    return true;
                }

            //function areFilingPartiesAssigned() {
            //    var i = 0;
            //    var j = 0;
            //    //need at least one checked per row
            //    var retVal = false;
            //    for (i = 0; i < otherCounter; i++) {
            //        //check database
            //        for (j = 0; j <= rowCount; j++) {
            //            if ($('#filer_' + i + '_' + j).prop('checked') == true) {
            //                retVal = true;
            //            }
            //        }
            //        //check normal entries
            //        for (j = 0; j < counter; j++) {
            //            var y = (j + rowCount + 1);
            //            if ($('#filer_' + i + '_' + y).prop('checked') == true) {

            //                retVal = true;

            //                //set the exemption file party to the first one checked. We need some sort of default value for this document,
            //                //and there is no input for the party on 3C
            //                if (exemptionParty == "") {
            //                    exemptionParty = $('#filer_' + i + '_' + j).parent().text();
            //                }
            //            }

            //            if (retVal != true)
            //                return false;
            //            //reset for next roww
            //            retVal = false;
            //        }
            //        return true;
            //    }
            //}

            $.validator.addMethod(
                "regex",
                function (value, element, regexp) {
                    var re = new RegExp(regexp);
                    return this.optional(element) || re.test(value);
                },
                ""
            );


            $("#form4").validate({
                rules: {
                    firstName: {
                        required: true,
                    },
                    lastName: {
                        required: true,
                    },
                    phoneNumber: {
                        required: true,
                        regex: /^\(?([0-9]{3})\)?([ .-]?)([0-9]{3})\2([0-9]{4})$/,/* /^\\(?\d{3}\\)?-? *\\d{3}-? *-?\\d{4}$/*/
                    },
                    priEmail: {
                        required: true,
                        regex: /^(([0-9a-zA-Z√Ä-√ø]).*)@((([0-9a-zA-Z√Ä-√ø\-]){1,})((\.[A-Za-z√Ä-√ø0-9]{2,}){1,}))$/,
                        email: true,
                    },
                    secEmail: {
                        required: false,
                        regex: /^(([0-9a-zA-Z√Ä-√ø]).*)@((([0-9a-zA-Z√Ä-√ø\-]){1,})((\.[A-Za-z√Ä-√ø0-9]{2,}){1,}))$/,
                        email: true,
                    },
                    regOfficeDDL: {
                        required: true,
                    },
                    languageDDL: {
                        required: true,
                    },
                    provinceDDL: {
                        required: false,
                    },
                    postalCode: {
                        required: false,
                        regex: /^[aA-zZ]{1}[0-9]{1}[aA-zZ]{1}\s?[0-9]{1}[aA-zZ]{1}[0-9]{1}$/,
                    },


                },
                messages: {
                    firstName: "<span style=\"color: red;\">Filing party first name is required</span>",
                    lastName: "<span style=\"color: red;\">Filing party last name is required.</span>",
                    phoneNumber: {
                        regex: "<span style=\"color: red;\">Filing party phone number must be of the following format 999-999-9999</span>",
                        required: "<span style=\"color: red;\">Filing party phone number is required.</span>",
                    },
                    priEmail: {
                        required: "<span style=\"color: red;\">Filing party primary email is required.</span>",
                        email: "<span style=\"color: red;\">Not a valid Email Address</span>"
                    },
                    secEmail: {
                        email: "<span style=\"color: red;\">Not a valid Email Address</span>"
                    },
                    regOfficeDDL: "<span style=\"color: red;\">The registry office is required.</span>",
                    languageDDL: "<span style=\"color: red;\">Language of communication with Registry is required</span>",
                    
                    postalCode: "<span style=\"color: red;\">Postal Code must be of the following format A9A 9A9</span>"
                }
            });

            $("#form2").validate(
                {
                    rules: {
                        firstName: {
                            required: true
                        },
                        lastName: {
                            required: true
                        },
                        partyType: {
                            required: true
                        },
                        partyRole: {
                            required: true
                        }

                    },
                    messages: {
                        firstName: "<span style=\"color: red;\">Filing party first name is required</span>",
                        lastName: "<span style=\"color: red;\">Filing party last name is required.</span>",
                        partyType: "<span style=\"color: red;\">Select One: Individual/Other</span>",
                        partyRole: "<span style=\"color: red;\">Party Role is required</span>",
                    }
                });
            $("#form3").validate();


            $("#form3c").validate(
                {
                    rules: {
                        exemptionFile: {
                            required: true
                        },
                        exemptionDocumentLanguage: {
                            required: true
                        }

                    },
                    messages: {
                        exemptionFile: "</br><span style=\"color: red;\">Please select a document to add to the filing.</span>",
                        exemptionDocumentLanguage: "<span style=\"color: red;\">Please select the document language.</span>",
                    }

                });

            $("#form4").validate();




            $("#Submit-Step-5").on("click", function (e) { //document info

                e.preventDefault();
                $('.ajaxMe').load("/onlineaccess/updateSubmission", { lang: "False" });
                $(".stepFive").hide();
                hidden = true;
                tablistelement.scrollIntoView();

            });


            $("#Submit-Step-2").on("click", function (e) { //Party info
                e.preventDefault();

                var firstnames = document.getElementsByName("firstName[]");
                var lastnames = document.getElementsByName("lastName[]");

                for (var i = 0; i < firstnames.length; i++) {
                    if (firstnames[i].value.trim().length == 0) {
                        firstnames[i].value = "";
                    }
                }
                for (var i = 0; i < lastnames.length; i++) {
                    if (lastnames[i].value.trim().length == 0 && lastnames[i].readOnly == false) {
                        lastnames[i].value = "";
                    }
                }

                $('.new').each(function () {
                    $(this).rules("add", {
                        required: true
                    });
                });
                if ($("#form2").valid()) {

                    //Grab number of party members
                    var numPartyMembers = $("#PartyList  tbody tr").length;

                    //Grab value for minimum parties required
                    var minPartiesRequired = $("#numPartiesReq").text();

                    //Number of members in the party has to be greater or equal to the amount required
                    //ITA/ETA proceedings need 1 party minimum; everything else needs min 2 parties
                    if (numPartyMembers => minPartiesRequired) {

                        console.log('valid');

                        //min amount of party members required was met; so proceed to step 3
                        $('#step-3-tab').removeClass("disabled");
                        $('#tablist a[href="#step-3"]').tab('show');
                        tablistelement.scrollIntoView();
                    }
                    else {
                        console.log('not valid missing at least one party');
                        var msg = "Filing Parties are required";
                        alert(msg);
                    }
                }

            });

            $("#Submit-Step-3").on("click", function (e) { //document info
                e.preventDefault();
                //update the rules!
                //CheckSession();

                //$('.newer').each(function () {
                //    $(this).rules("add", {
                //        required: true
                //    });
                //});

                if ($("#form3").valid()) {
                    if (otherCounter > 0) { //need at least one document
                        if (areFilingPartiesAssigned()) {
                            if (sigsNeeded) {
                                if ($('#Signatures').prop('checked') == true) {   //check for signed if true then submit files

                                    OnlineAccessCriteriaMet();

                                    if (OnlineAccess == true) {
                                        Step3b(); //move to step 3b
                                    } else {
                                        Step4();
                                        //move to step 4
                                    }
                                }
                                else {
                                    console.log('need to check that box!');
                                    var x = "Please confirm that you agreed to keep signed copies";
                                    alert(x);
                                }
                            }
                            else {
                                OnlineAccessCriteriaMet();
                                if (OnlineAccess == true) {
                                    Step3b();
                                } else {
                                    Step4();
                                }
                            }
                        }
                        else {
                            console.log('not valid a document is not assigned a filing party');
                            var x = "Filing Parties are required";
                            alert(x);
                        }
                    }
                    else {
                        console.log('not valid missing at least one document');
                        var x = "The filing must include at least one document.";
                        alert(x);
                    }
                    tablistelement.scrollIntoView();
                }
                else {
                    console.log('not valid');

                }
            });

            //To go to Step 3b
            function Step3b() {

                $('#step-3-tab').hide();
                $('#step-3b-tab').show();
                $('#step-3b-tab').removeClass("disabled");
                $('#tablist a[href="#step-3b"]').tab('show');
                $('#datatable3b').show();
            }

            $("#Submit-Step-3b").on("click", function (e) {
                e.preventDefault();

                validate3B();

                //if 3b is valid and use requested exemption, go to 3C
                if (pathway == 2) {

                    $('#step-3b-tab').hide();
                    $('#step-3c-tab').show();
                    $('#step-3c-tab').removeClass("disabled");
                    $('#tablist a[href="#step-3c"]').tab('show');

                    Populate3C();
                }

                //go to step 4 instead of 3C if there is no request for exemption
                else if (pathway == 3) {

                    Step4();
                }

            });

            $("#Submit-Step-3c").on("click", function (e) { //document info
                //FC wanted this extra error message alert
                if ((document.getElementById('exemptionFile').value == '') && (document.getElementById('exemptionDocumentLanguage').selectedIndex == 0)) {
                    alert("You must provide a document in support of your request for exemption.");
                }

                //check if the form is valid - ensure they have filled out the fields
                if ($("#form3c").valid()) {


                    Step4();
                }
            });

            $("#Submit-Step-4").on("click", function (e) { //file info
                e.preventDefault();
                tablistelement.scrollIntoView();
                var nodes = document.querySelectorAll("input[type=text]");

                for (var i = 0; i < nodes.length; i++) {
                    if (nodes[i].value.trim().length == 0) {
                        nodes[i].value = "";
                    }
                }

                //check urgency
                isUrgencyChecked();
                if ($("#form4").valid()) {

                    console.log('valid');
                    $('#step-5-tab').removeClass("disabled");
                    $('#tablist a[href="#step-5"]').tab('show');
                    Submit();


                    tablistelement.scrollIntoView();
                }
                else {
                    console.log('not valid');
                }
                //Enable submit while data populated
                //$(':input[type="submit"]').prop('disabled', true);
                //$('input[type="text"]').keyup(function () {
                //    if (typeof $(dataInputIndicator) !== 'undefined') {
                //        if ($(dataInputIndicator).val() != '') {
                //            $(':input[type="submit"]').prop('disabled', false);
                //        }
                //    }
                //});
            });

            function SubmitFiles() {
                var valid = false;
                var x = 0;

                var fileData = new FormData();

                for (x = 0; x < otherCounter; x++) {
                    for (var i = 0; i < $("#file_" + x).get(0).files.length; i++)
                        fileData.append('userfiles[]', $("#file_" + x).get(0).files[i]);
                }

                //check if we need to get the file in the request for exemption file input or not
                if (pathway == 2) {
                    fileData.append('userfiles[]', $("#exemptionFile").get(0).files[0]);
                }

                $.ajax({
                    type: "POST",
                    url: "/onlineaccess/uploadFiles",
                    data: fileData,
                    dataType: "json",
                    contentType: false,
                    processData: false,
                    error: function (jqXHR, result) {
                        console.log(jqXHR);
                        var ricky = (jqXHR.responseText);
                        if (ricky != "") {
                            alert(ricky);
                            valid = false;
                        }
                        else { valid = true; }
                        if (valid) {
                            console.log('valid');
                            //removed to accomodate the possibility of going from step 3a to 3b instead of 3a to 4
                            //$('#step-4-tab').removeClass("disabled");
                            //$('#tablist a[href="#step-4"]').tab('show');
                        }
                        else {
                            console.log('Document upload reported errors to user');
                        }
                    }

                });

            }

            function Step4() {

                SubmitFiles();

                $('#step-4-tab').removeClass("disabled");
                $('#tablist a[href="#step-4"]').tab('show');

            }

            function Submit() {
                //userdefineded Party was defined here

                createFileLists();
                userDefinedParty = [];
                createPartyLists();

                //update list of documents to add document from 3C
                if (pathway == 2) {
                    addFileFrom3c();
                }


                var model2 = {

                    //form4
                    firstName: $('#firstName').val(),
                    lastName: $('#lastName').val(),
                    phoneNumber: $('#phoneNumber').val(),
                    priEmail: $('#priEmail').val(),
                    secEmail: $('#secEmail').val(),
                    languageDDL: $('#languageDDL  option:selected').text(),
                    languageDDLCode: $('#languageDDL').val(),
                    regOfficeDDL: $('#regOfficeDDL').val(),
                    provinceDDL: $('#provinceDDL').val(),
                    isUrgent: $('#isUrgent').is(':checked'),
                    urgDesc: $('#urgDesc').val(),
                    postalCode: $('#postalCode').val(),
                    city: $('#City').val(),
                    address: $('#Address').val(),
                };



                $.ajax({
                    url: "/onlineaccess/submitInternalOffice",
                    type: "POST",
                    dataType: "json",
                    async: false,
                    data: JSON.stringify({ iOfficeNo: $('#iOfficeNumber').val() }),
                    contentType: "application/json; charset=utf-8",
                });

                var postData = {
                    s2: userDefinedParty,
                    s3: fileList,
                    ued: model2,
                };

                $.ajax({
                    url: '/onlineaccess/ExistingSubmit',//"/onlineaccess/ExistingSubmit",
                    type: "post",
                    data: JSON.stringify(postData),
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        //userDefinedParty = [];
                        //databaseDefinedParty = [];
                        //counter = 0;
                        //rowCount = 0;
                        //fileList = [];
                        //otherCounter = 0;


                        $('.ajaxMe').load("/onlineaccess/updateSummary", { lang: "False" });
                    }
                });



                  //  success: function (result) {
                        //userDefinedParty = [];
                        //databaseDefinedParty = [];
                        //counter = 0;
                        //rowCount = 0;
                        //fileList = [];
                        //otherCounter = 0;

                      //  $('.ajaxMe').load("/onlineaccess/updateSummary", { lang: "False" });
                  //  },



             //   });

            } //end submit


            function createPartyLists() {
                var i = 0;

                var table = document.getElementById("PartyList").getElementsByTagName('tbody')[0];
                var size = table.rows.length;
                for (i = 0; i < size; i++) {
                    var Party = {};
                    Party.role = $('#PartyRole_' + i).val();
                    Party.type = $('#PartyType_' + i).val();
                    Party.firstName = $('#firstName_' + i).val();
                    Party.lastName = $('#lastName_' + i).val();

                    userDefinedParty.push(Party);
                }
            }

            function createFileLists() {
                var i = 0;
                var j = 0;
                fileList = []; //clean start [back forward page movement was creating ghost entries]
                for (i = 0; i < otherCounter; i++) {
                    var docs = {};
                    var filingParties = [];
                    docs.documentType = $('#DocumentType_' + i).val();
                    docs.documentLang = $('#DocumentLanguage_' + i).val();
                    docs.documentFileNameFromUpload = $('#file_' + i).val();

                    docs.documentHandling = $('#DocumentHandling_' + i).val();

                    //need this loop to check if the dropdown exists or not, because the rows with "Not applicable" do not have a select
                    //element and therefor do not have an ID to check. They will be undefined.
                    var OADropDownId = "OADropDown_" + i;
                    if (document.contains(document.getElementById(OADropDownId))) {
                        docs.exemptionType = $('#OADropDown_' + i).val();
                    } else {
                        docs.exemptionType = "Not Applicable";
                    }

                    //need to loop through list and find those check marks that are true
                    var numParties = userDefinedParty.length;
                    for (j = 0; j < numParties; j++) {
                        if ($('#filer_' + i + '_' + j).prop('checked')) {
                            {
                                var party = j; //databaseDefinedParty[j].firstName + ' ' + databaseDefinedParty[j].lastName;
                                filingParties.push(party);
                            }

                        }
                    }
                    //for (j = 0; j < counter; j++) {
                    //    var x = (rowCount + j + 1);
                    //    if ($('#filer_' + i + '_' + x).prop('checked')) {
                    //        var party = x;//userDefinedParty[j].firstName + ' ' + userDefinedParty[j].lastName;
                    //        filingParties.push(party);
                    //    }
                    //}



                    docs.party = filingParties;
                    fileList.push(docs);
                    //do we care about the documents?
                }
            }

            function addFileFrom3c() {
                //based on the mechanism in CreateFileLists()
                var doc = {};
                var filingParties = [];
                //doc.party = exemptionParty;
                filingParties.push(exemptionParty);//get exemptionParty value from areFilingPartiesAssigned() - it will default to the first checked filing party of any document
                doc.party = filingParties;
                var docType = "Request for exemption";
                doc.documentType = docType.toUpperCase(); //needed so it matches the document type in the database
                doc.documentLang = $('#exemptionDocumentLanguage').val();
                doc.documentFileNameFromUpload = $('#exemptionFile').val();
                //default to request for exemption
                doc.exemptionType = "Request for exemption";

                fileList.push(doc);

            }


            function updateIndexes(table) {
                // get every tr element except the header
                table.find("tr:gt(0)").each(function (j, row) {
                    // get every input and select elements
                    $(row).find('input, select,textarea,span').each(function (k, input) {
                        // check whether the id-attribute is of type _[index]__
                        var id = input.id.match(/\d+/);
                        // if it is an element necessary for the ModelBinder => update the name attribute
                        if (id != null && id.length && id.length == 1) {
                            var attr = $(input).attr("id");

                            // replace the old index of the name attribute with the calculated index
                            var newName = attr.replace(attr.match(/\d+/), j);
                            $(input).attr("id", newName);
                        }
                    });
                });
            }

            function updatePartyIndexes(table) {
                // get every tr element except the header
                table.find("tr:gt(0)").each(function (j, row) {
                    // get every input and select elements
                    $(row).find('input, select,textarea,span').each(function (k, input) {
                        // check whether the id-attribute is of type _[index]__
                        var id = input.id.match(/\d+/);
                        // if it is an element necessary for the ModelBinder => update the name attribute
                        if (id != null && id.length && id.length == 1) {
                            var attr = $(input).attr("id");

                            // replace the old index of the name attribute with the calculated index
                            var newName = attr.replace(attr.match(/\d+/), j);
                            //var x = j - rowCount;
                            $(input).attr("id", newName);
                            $(input).attr("name", newName);



                        }
                    });
                });
            }


            //Ajaxing in Parties
            var counter = 0;
        var otherCounter = 0;
        function FilingPartyList(otherCounter) {
            userDefinedParty = [];
            createPartyLists();
            var x = 0;
            var retVal = '<div class="textAreaBoxStyle" style="overflow:auto; height: 150px">';
            userDefinedParty.forEach(function (party, index, arr) {
                retVal = retVal + '<p><input type="checkbox" id="filer_' + otherCounter + "_" + index + '">' + party.firstName + ' ' + party.lastName + '</p>';
            });
            //for (x = 1; x <= (rowCount); x++) {
            //    retVal = retVal + '<p><input type="checkbox" id="filer_' + otherCounter + '_' + x + '">' + databaseDefinedParty[x].firstName + ' ' + databaseDefinedParty[x].lastName + '</p>';
            //}

            //for (x = 0; x < counter; x++) {
            //    var y = x + (rowCount + 1);
            //    retVal = retVal + '<p><input type="checkbox" id="filer_' + otherCounter + '_' + y + '">' + userDefinedParty[x].firstName + ' ' + userDefinedParty[x].lastName + '</p>';
            //}

            retVal = retVal + '</div>';
            return retVal;
        }

        //function FilingPartyList(otherCounter) {
        //        createPartyLists();
        //        var x = 0;
        //        var retVal = '<div class="textAreaBoxStyle" style="overflow:auto; height: 150px">';
        //        for (x = 1; x <= (rowCount); x++) {
        //            retVal = retVal + '<p><input type="checkbox" id="filer_' + otherCounter + '_' + x + '">' + databaseDefinedParty[x].firstName + ' ' + databaseDefinedParty[x].lastName + '</p>';
        //        }

        //        for (x = 0; x < counter; x++) {
        //            var y = x + (rowCount + 1);
        //            retVal = retVal + '<p><input type="checkbox" id="filer_' + otherCounter + '_' + y + '">' + userDefinedParty[x].firstName + ' ' + userDefinedParty[x].lastName + '</p>';
        //        }

        //        retVal = retVal + '</div>';
        //        return retVal;
        //    }

            $("#addrow").on("click", function () {
                var newRow = $("<tr>");
                var cols = "";

                cols += '<td width="15%"><select id="DocumentType_' + otherCounter + '" name="DocumentType_' + otherCounter + '" class="form-control newer" data-msg="Document Type is required." ></td>';
                //document selection button
                //cols += '<td width="20%" height="auto"><input type = "file"  id="file_' + otherCounter + '"name ="file_' + otherCounter + '" accept = "application/pdf" class="form-control newer" data-msg="Please select a document to add to the filing."/></td>';

                //<label for="fileUpload" class="file-upload btn btn-primary btn-block rounded-pill shadow"><i class="fa fa-upload mr-2"></i>Browse for file ...
                //        <input id="fileUpload" type="file">
                //    </label>

                //                <div class="custom-file">
                //                    <input type="file" class="custom-file-input" id="customFileLang" lang="es">
                //                        <label class="custom-file-label" for="customFileLang">Seleccionar Archivo</label>
                //</div>

                cols += '<td width="20%" height="auto"><div class="custom-file"><input type="file" id="file_' + otherCounter + '" name="file_' + otherCounter + '" accept="application/pdf" class="form-control newer" data-msg="Please select a document to add to the filing." /><label id="filelbl_' + otherCounter + '" class="custom-file-label" style="overflow:hidden" for="file_' + otherCounter + '" ></label></div></td>';
                // cols += '<td width="20%" height="auto"><div class="form-group"><input type = "file"  id="file_' + otherCounter + '"name ="file_' + otherCounter + '" accept = "application/pdf" class="filestyle" data-msg="Please select a document to add to the filing."/></div></td>';
                cols += '<td width="15%"><select id="DocumentLanguage_' + otherCounter + '" name="DocumentLanguage_' + otherCounter + '" class="form-control newer" data-msg="Please select the document language."></td>';
                //filingParties list
                cols += '<td width="25%">';
                cols += FilingPartyList(otherCounter);
                cols += '</td>';
                //handling instructions
                cols += '<td width="20%"><textarea id="DocumentHandling_' + otherCounter + '" name="DocumentHandling_' + otherCounter + '" class="form-control" maxlength="255"></textarea><span class="countDown_' + otherCounter + '" id="countDown_' + otherCounter + '"></span></td>';
                cols += '<td width="5%"><button id="' + otherCounter + '" class="delete btn-md btn-block btn-danger" name="delete" type="button">Remove</button></td></tr>';

                newRow.append(cols);
                $("table.doc-list").append(newRow);
                PopulateDocumentDropdowns(otherCounter);




                $("#file_" + otherCounter).on('change', function () {
                    var oFile = document.getElementById(this.id).files[0];
                    var x = $(this).attr('id').split("_");
                    var objtid = this.id;
                    var filelblobj = "filelbl_" + x[1];
                    var filename = this.value.replace(/C:\\fakepath\\/i, '');


                    if (oFile.size > 104857600) {
                        alert('Document must be less than 100Mb');
                        $("#" + filelblobj).text("");
                        $("#" + objtid).val('');
                    }
                    else {
                        if (oFile.type != "application/pdf") {
                            alert('Document Type must be PDF');
                            $("#" + filelblobj).text("");
                            $("#" + objtid).val('');
                        }
                        else {

                            $('#loadingscreen').show();
                            var xhr = new XMLHttpRequest();
                            xhr.open('POST', '/onlineaccess/CheckPdfProtection');
                            xhr.setRequestHeader('Content-type', 'multipart/form-data');
                            //Appending file information in Http headers
                            xhr.setRequestHeader('X-File-Name', oFile.name);
                            xhr.setRequestHeader('X-File-Type', oFile.type);
                            xhr.setRequestHeader('X-File-Size', oFile.size);
                            //Sending file in XMLHttpRequest
                            xhr.send(oFile);
                            xhr.onreadystatechange = function () {
                                if (xhr.readyState == 4 && xhr.status == 200) {
                                    //alert(xhr.responseText);
                                    if (xhr.responseText == "false") {
                                        $('#loadingscreen').hide();
                                        $("#" + filelblobj).text(filename);

                                    }
                                    else {
                                        $('#loadingscreen').hide();
                                        $("#" + filelblobj).text("");
                                        $("#" + objtid).val('');
                                        var x = "This PDF is protected, please add an unprotected PDF.";
                                        alert(x);

                                    }
                                }
                            }
                        }
                    }
                });


                $('#DocumentHandling_' + otherCounter).keyup(function () {
                    var x = $(this).attr('id').split("_");
                    $('#countDown_' + x[1]).text("Characters left:" + (255 - $(this).val().length));
                });

                otherCounter++;
            });

            $("table.doc-list").on("click", ".delete", function (event) {
                $(this).closest("tr").remove();
                otherCounter = otherCounter - 1;
                updateIndexes($("table.doc-list"));
                updateAllSignatures();
            });

            function PopulateDocumentDropdowns(otherCounter) {

                DocumentType(otherCounter);
                DocumentLanguage(otherCounter);


                function DocumentLanguage(otherCounter) {
                    var DDL_Model = { lang: "False" };
                    var jsonToPost = JSON.stringify(DDL_Model);
                    $.ajax({
                        url: '/onlineaccess/buildLanguageDDL',
                        type: "POST",
                        data: jsonToPost,
                        contentType: "application/json; charset=utf-8",
                        success: function (result) {
                            var s = '<option value="">---Choose One---</option>';
                            for (var i = 0; i < result.length; i++) {
                                s += '<option value="' + result[i] + '">' + result[i] + '</option>';
                            }
                            $("#DocumentLanguage_" + otherCounter).html(s);
                        }
                    })
                }

                function DocumentType(otherCounter) {
                    var DDL_Model = { lang: "False" };
                    var jsonToPost = JSON.stringify(DDL_Model);
                    $.ajax({
                        url: '/onlineaccess/buildFCTAllDocumentsDDL',
                        type: "POST",
                        data: jsonToPost,
                        contentType: "application/json; charset=utf-8",
                        success: function (result) {
                            var s = '<option value="">---Choose One---</option>';
                            for (var i = 0; i < result.length; i++) {
                                s += '<option value="' + result[i] + '">' + result[i] + '</option>';
                            }
                            $("#DocumentType_" + otherCounter).html(s);
                            $("#DocumentType_" + otherCounter).on('change', function () {
                                updateAllSignatures();
                                if (sigsNeeded) {
                                    $('.ajaxSignatures').show();
                                }
                                else {
                                    $('.ajaxSignatures').hide();
                                    $("#Signatures").prop('checked', false);
                                }
                            });
                        }
                    })
                }


        }

                function addParty() {

                        var table = document.getElementById("PartyList").getElementsByTagName('tbody')[0];
                        counter = table.rows.length;

                var newRow = $("<tr>");
                var cols = "";
                cols += '<td width="20%"><select id="PartyRole_' + counter + '" name="PartyRole_' + counter + '" class="form-control new"  data-msg="Filing Parties are required"></td>';
                cols += '<td width="15%"><select id="PartyType_' + counter + '" name="PartyType_' + counter + '" class="form-control new dropdowntarget"data-msg="Select One: Individual/Other"></td>';
                cols += '<td width="30%"><input type="text" class="form-control new" id="firstName_' + counter + '" name="firstName[]" data-msg="Filing party first name is required" maxlength="100"/></td>';
                cols += '<td width="25%"><input type="text" class="form-control new" id="lastName_' + counter + '" name="lastName[]" data-msg="Filing party last name is required." maxlength="100"/></td>';

                cols += '<td width="10%"><input type="button" class="ibtnDel btn btn-md btn-danger"  value="Remove"></td>';
                newRow.append(cols);
                $("#PartyList").append(newRow);
                PopulateDropdowns(counter);

                counter++;

            }

            

            function removePartyRow(event) {
                $(this).closest("tr").remove();
                updatePartyIndexes($("table.party-list"));
                counter--;
            }

            function RestrictDropDown(counter) {
                //we know what row;
                //find out what if other, selected remove rule off lastname or give it a whitespace value and lock it.
                var x = $("#PartyType_" + counter).find('option:selected').text();
                if (x == "Other") {
                    $("#lastName_" + counter).val(" ");
                    $("#lastName_" + counter).attr('readonly', true);
                    $("#firstName_" + counter).attr('maxlength', '150');
                }
                else {
                    $("#lastName_" + counter).val("");
                    $("#lastName_" + counter).attr('readonly', false);
                    $("#firstName_" + counter).attr('maxlength', '100');
                }

            }


            function PopulateDropdowns(counter) {

                PartyRoles(counter);
                PartyTypes(counter);

                function PartyRoles(counter) {
                    var DDL_Model = {

                        lang: "False"
                    };

                    var jsonToPost = JSON.stringify(DDL_Model);
                    $.ajax({
                        url: '/onlineaccess/buildFCPartyRoleDDL',
                        type: "POST",
                        data: jsonToPost,
                        contentType: "application/json; charset=utf-8",
                        success: function (result) {
                            var s = '<option value="">---Choose One---</option>';
                            for (var i = 0; i < result.length; i++) {
                                s += '<option value="' + result[i] + '">' + result[i] + '</option>';
                            }
                            $("#PartyRole_" + counter).html(s);
                        }
                    })
                }

                function PartyTypes(counter) {
                    var DDL_Model = { lang: "False" };

                    var jsonToPost = JSON.stringify(DDL_Model);
                    $.ajax({
                        url: '/onlineaccess/buildPartyTypeDDL',
                        type: "POST",
                        data: jsonToPost,
                        contentType: "application/json; charset=utf-8",
                        success: function (result) {
                            var s = '<option value="">---Choose One---</option>';
                            for (var i = 0; i < result.length; i++) {
                                s += '<option value="' + result[i] + '">' + result[i] + '</option>';
                            }
                            $("#PartyType_" + counter).html(s);
                            //$("#PartyType_" + counter).on('change', function () { RestrictDropDown(counter) });
                        }
                    })
                }



            }

            function GenerateTextBox() {
                var x = "Clicking Back Button resets page data";
                return confirm(x);
            }

            function deleteFiles() {
                $.ajax({
                    url: '/onlineaccess/deleteAllFiles',
                    type: "post",
                    contentType: "application/json; charset=utf-8",
                });

            }

            function OnlineAccessCriteriaMet() {

                

                //if filing date, is after\ goLiveDate then setPilot(true)
              //  var fileDateValidTemp = '';
                

                

                        //   if (publishableNature) {
                                var docTypes = [];
                                var documentExists = true;
                                var documentCounter = 0;

                                //need this to decide which language of parameter from Model (AllUserData).CourtLookForUser to send in Ajax call
                                //var lang = "False";

                                while (documentExists) {
                                    /*var document = document.getElementById(documentId).val();*/
                                    var documentId = "DocumentType_" + documentCounter;

                                    var doc = document.getElementById(documentId);

                                    if (doc == null) {
                                        documentExists = false;
                                    }

                                    else {
                                        var docType = doc.value;
                                        docTypes.push(docType);
                                        documentCounter++;
                                    }
                                }



                                var x = {
                                    documents: docTypes,
                                };

                                $.ajax({
                                    url: "/OnlineAccess/OnlineAccessCriteriaMetExisting",
                                    type: "POST",
                                    data: JSON.stringify(x),
                                    async: false,
                                    contentType: "application/json; charset=utf-8:",

                                    success: function (result) {
                                        if (result) {
                                            setPilot(true);
                                            //another ajax call to populate a list of documents that are of the pilot document types? Then use this to populate the table via js
                                            getListOfOnlineAccessDocuments();
                                        }

                                        else {
                                            setPilot(false);
                                        }
                                    }

                                });
                       //     }

             //   else setPilot(false);

                        

            }



            function setPilot(x) {
                OnlineAccess = x;
            }

            //used to populate table in 3b
            function getListOfOnlineAccessDocuments() {
                $.ajax({
                    url: "/OnlineAccess/getListOfOnlineAccessDocuments",
                    type: "GET",
                    async: false,
                    contentType: "application/json; charset=utf-8:",

                    success: function (result) {
                        //add each item in result to the listOfOnlineAccessDocs
                        result.forEach((x, i) => listOfOnlineAccessDocs.push(x));

                        //for each row in #docList where value = value in listOfOnlineAccessDocs:
                        //make new row in #dataTable3b

                        var table = document.getElementById("docList");
                        //var row = table.rows[i++];
                        var count = $("#docList > tbody").children().length;
                        for (var i = 0; i < count; i++) {

                            var documentTypeId = "DocumentType_" + i;
                            var documentType = document.getElementById(documentTypeId).value;

                            var documentNameId = "file_" + i;
                            var documentName = document.getElementById(documentNameId).value;

                            //remove fake path
                            var tempDocName = documentName.split("\\");
                            //get last part of path (ie go from C:\\fakepath\\filename to filename)
                            var documentName = tempDocName[tempDocName.length - 1];


                            var onlineAccessDropDownId = "OADropDown_" + i;

                            var removeButtonId = "RemoveDocument_" + i;

                            if (listOfOnlineAccessDocs.includes(documentType)) {
                                //add additional id to the td so it's value can be accessed easily by the table in Step 3C
                                var tdDocTypeId = "td_docType_" + i;

                                var tdNameId = "td_name_" + i;

                                var col = '<tr><td id="' + tdDocTypeId + '">' + documentType + '</td><td id="' + tdNameId + '">' + documentName + '</td><td><select id="' + onlineAccessDropDownId + '"></td><td><button id="' + removeButtonId + '" class="delete btn-md btn-block btn-danger" type="button">Remove Confidential Document</td></tr>';

                                $("#documentList3b").append(col);
                                PopulateOnlineAccessDropdown(onlineAccessDropDownId);
                            }

                            else {

                                var col = '<tr><td>' + documentType + '</td><td>' + documentName + '</td><td>Not Applicable</td><td></td></tr> ';
                                $("#documentList3b").append(col);
                            }


                        }
                    }
                });
            }

            //Populate the OnlineAccess Dropdown menu in step 3B
            function PopulateOnlineAccessDropdown(onlineAccessDropDownId) {
                var DDL_Model = { lang: "False" };
                var jsonToPost = JSON.stringify(DDL_Model);
                $.ajax({
                    url: '/onlineaccess/buildOnlineAccessDDL',
                    type: "POST",
                    data: jsonToPost,
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        var s = '<option value="---Choose One---">---Choose One---</option>';
                        for (var i = 0; i < result.length; i++) {
                            s += '<option value="' + result[i] + '">' + result[i] + '</option>';
                        }
                        $("#" + onlineAccessDropDownId).html(s);
                    }
                });
            }


            //will set global variable "pathway" declared at top of script. The following functions will add a number to the priority array
            //as each document is looped through. The pathway variable is assigned the min number( highest priority) in priority, and controls navigation
            //priority 1 will be taken, then 2, then 3
            // 1 - form invalid (either did not fill in all required fields, or selected a confidential type)
            // 2 - request for exemption present -> go to step 3C
            // 3 - no request for exemption present, but form is otherwise valid -> go to step 4
            function validate3B() {

                var priority = [];

                var DDL_Model = { lang: "False" };
                var jsonToPost = JSON.stringify(DDL_Model);
                $.ajax({
                    url: '/onlineaccess/getAllowedOnlineAccessTypes',
                    type: "POST",
                    async: false,
                    data: jsonToPost,
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {

                        var count = $("#documentList3b").children().length;
                        for (var i = 0; i < count; i++) {

                            var onlineAccessDropDownId = "OADropDown_" + i;

                            //check if the element exists, to prevent breaking on docs with N/A value in Online Access column
                            if (document.contains(document.getElementById(onlineAccessDropDownId))) {

                                //get user selection from Online Access dropdown
                                var selection = document.getElementById(onlineAccessDropDownId).value;

                                //if user hasn't selected a value, notify them and block forward navigation
                                if (selection == "---Choose One---") {
                                    alert("You must make a selection for each document.");
                                    priority.push(1); //invalid. User must deal with issue in prompt. Highest priority
                                }

                                //if the selection is not in the allowed list, alert user and block forward navigation
                                else if (!result.includes(selection)) {
                                    alert("You cannot file confidential documents via the Federal Court Electronic Filing System. Please remove the document.");
                                    priority.push(1); //invalid. User must deal with issue in prompt. Highest priority
                                }

                                else {
                                    $.ajax({
                                        url: '/onlineaccess/getRequestForExemptionValues',
                                        type: "GET",
                                        async: false,
                                        contentType: "application/json; charset=utf-8",
                                        success: function (result) {
                                            if (result.includes(selection)) {
                                                priority.push(2); //valid, request for exemption present. Middle priority
                                            }
                                            else
                                                //valid, no request for exemption - lowest priority
                                                priority.push(3);
                                        }
                                    });
                                }
                            }
                        }
                        //for condition where user clicks every remove confidential document button, leaving just N/A documents in the table
                        if (priority.length == 0) {
                            priority.push(3);
                            OnlineAccess = false;
                        }
                    }
                });
                //set pathway control to the highest priority (min value)
                pathway = Math.min(...priority);


            }

            //3B delete buttons
            $("#documentList3b").on("click", ".delete", function (event) {

                //get row index, use it to remove document from 3A as well.
                var index = $(this).closest("tr").index();

                $(this).closest("tr").remove();

                //remove corresponding row in 3A
                $('#docListBody tr').eq(index).remove();

                //need to change indexes now.

                updateIndexes($("#docList"));
                otherCounter--;

            });

            //for the language dropdown in 3C
            function PopulateExemptionDocLanguageDropdown() {
                var DDL_Model = { lang: "False" };
                var jsonToPost = JSON.stringify(DDL_Model);
                $.ajax({
                    url: '/onlineaccess/buildLanguageDDL',
                    type: "POST",
                    data: jsonToPost,
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        var s = '<option value="">---Choose One---</option>';
                        for (var i = 0; i < result.length; i++) {
                            s += '<option value="' + result[i] + '">' + result[i] + '</option>';
                        }
                        $("#exemptionDocumentLanguage").html(s);
                    }
                });
            }

            function Populate3C() {
                //for each row in 3b table
                //var table = document.getElementById("docList3b");

                var docName = '';

                //iterate through rows of table in 3B
                var count = $("#documentList3b").children().length;
                for (var i = 0; i < count; i++) {

                    //get document name, document type
                    var tdNameId = "td_name_" + i;

                    //need to check if the element exists, because in the 3B table the documents that do not
                    //qualify for online access are not assigned an ID.

                    //must also check if the row's select value = Request for exemption / Demande d'exemption
                    if (document.contains(document.getElementById(tdNameId))) {

                        docName += document.getElementById(tdNameId).innerHTML;
                        docName += "</br>";

                    }
                }
                //add to respective 3c table td item
                $('#exemptionDocNames').html(docName);
                PopulateExemptionDocLanguageDropdown();

            }

            //remove button functionality on 3C - clears file input and language selection
            $(document).ready(function () {
                $('#exemptionRemove').on('click', function (e) {
                    var $el = $('#exemptionFile');
                    $el.wrap('<form>').closest('form').get(0).reset();
                    $el.unwrap();
                    document.getElementById('exemptionDocumentLanguage').selectedIndex = 0;
                    $("#exemptionFileLabel").text('');
                });
            });

            //functionality for document select on 3C
            $("#exemptionFile").on('change', function () {
                var oFile = document.getElementById(this.id).files[0];
                var x = $(this).attr('id');
                var objtid = this.id;
                var filelblobj = "exemptionFileLabel";
                var filename = this.value.replace(/C:\\fakepath\\/i, '');


                if (oFile.size > 104857600) {
                    alert('Document must be less than 100Mb');
                    $("#" + filelblobj).text("");
                    $("#" + objtid).val('');
                }
                else {
                    if (oFile.type != "application/pdf") {
                        alert('Document Type must be PDF');
                        $("#" + filelblobj).text("");
                        $("#" + objtid).val('');
                    }
                    else {
                        $('#loadingscreen').show();
                        var xhr = new XMLHttpRequest();
                        xhr.open('POST', '/onlineaccess/CheckPdfProtection');
                        xhr.setRequestHeader('Content-type', 'multipart/form-data');
                        //Appending file information in Http headers
                        xhr.setRequestHeader('X-File-Name', oFile.name);
                        xhr.setRequestHeader('X-File-Type', oFile.type);
                        xhr.setRequestHeader('X-File-Size', oFile.size);
                        //Sending file in XMLHttpRequest
                        xhr.send(oFile);
                        xhr.onreadystatechange = function () {
                            if (xhr.readyState == 4 && xhr.status == 200) {
                                //alert(xhr.responseText);
                                if (xhr.responseText == "false") {
                                    $('#loadingscreen').hide();
                                    $("#" + filelblobj).text(filename);
                                }
                                else {
                                    $('#loadingscreen').hide();
                                    $("#" + filelblobj).text("");
                                    $("#" + objtid).val('');

                                    var x = "This PDF is protected, please add an unprotected PDF.";
                                    alert(x);

                                }
                            }
                        }
                    }
                }

            });

            }); //end of main function
    </script>



    <script type="text/javascript">
        $body = $("body");
        $(document).on({
            //ajaxStart: function () { $body.addClass("loading"); },
            //ajaxStop: function () { $body.removeClass("loading"); },
            //ajaxError: function (xhr, txt, err) { redirectToErrorPage(); }
            ajaxStart: function () { $('#loadingscreen').show(); },
            ajaxStop: function () { $('#loadingscreen').hide(); },

        });

        $(document).ready(function () {

            //CheckSession();
            $('[data-toggle="tooltip"]').tooltip();
         
            $('#idMyBtn').on('click',
                function (event) {
                    $('#idMyBtn').prop('disabled', true);
                    $('#idMyForm').submit();
                }

            );

            
        });

    //function CheckSession() {
    //    $.ajax({

    //        type: 'POST',
    //        dataType: 'json',
    //        contentType: 'application/json',
    //        url: '/OnlineAccess/SessionInfo',
    //        data: '{}',
    //        success: function (data) {
    //            //alert(data.sessionValue);
    //            if (data.expired == true) {
    //                if (data.lang == "en") {
    //                    location.href = "/en/online-access/sessionExpiration"
    //                }
    //                else {
    //                    location.href = "/fr/acces-en-ligne/sessionExpiration"
    //                }
    //            }
    //            else {
    //                if (data.lang == "en") {
    //                    //location.href = "/en/online-access/sessionExpiration"
    //                }
    //                else {
    //                   // location.href = "/fr/acces-en-ligne/sessionExpiration"
    //                }
    //                //location.href = "/Home/Login"
    //            }
    //        },
    //        error: function (xhr) {
    //            alert('error');
    //        }
    //    });

    
//}

    </script>




</body>